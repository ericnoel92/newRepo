<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enregistrement Vidéo</title>
</head>
<body>
    <h1>Enregistrement Vidéo</h1>
    <video id="webcam" autoplay></video>
    <button id="startButton">Commencer l'enregistrement</button>
    <button id="stopButton" disabled>Arrêter l'enregistrement</button>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let videoStream;
            let mediaRecorder;
            let chunks = [];

            const video = document.getElementById('webcam');
            const startButton = document.getElementById('startButton');
            const stopButton = document.getElementById('stopButton');

            startButton.addEventListener('click', startRecording);
            stopButton.addEventListener('click', stopRecording);

            function startRecording() {
                navigator.mediaDevices.getUserMedia({ video: true })
                    .then((stream) => {
                        videoStream = stream;
                        video.srcObject = stream;

                        mediaRecorder = new MediaRecorder(stream);
                        mediaRecorder.ondataavailable = handleDataAvailable;
                        mediaRecorder.onstop = handleStop;

                        chunks = [];
                        mediaRecorder.start();

                        // Désactiver le bouton de démarrage et activer le bouton d'arrêt
                        startButton.disabled = true;
                        stopButton.disabled = false;

                        // Arrêter l'enregistrement après 5 secondes (5000 millisecondes)
                        setTimeout(() => {
                            stopRecording();
                        }, 5000);
                    })
                    .catch((error) => {
                        console.error('Error accessing the webcam:', error);
                    });
            }

            function stopRecording() {
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();

                    // Désactiver le bouton d'arrêt et activer le bouton de démarrage
                    startButton.disabled = false;
                    stopButton.disabled = true;
                }
            }

            function handleDataAvailable(event) {
                if (event.data.size > 0) {
                    chunks.push(event.data);
                }
            }

            function handleStop() {
                const blob = new Blob(chunks, { type: 'video/webm' });
                const videoURL = URL.createObjectURL(blob);
                video.srcObject = null;
                video.src = videoURL;
            }
        });
    </script>
</body>
</html>
